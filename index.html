<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>مصر 2030: التحفة النهائية - الإصدار السينمائي</title>

  <!-- خطوط -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Reem+Kufi+Fun:wght@700&family=Amiri:wght@700&display=swap" rel="stylesheet">

  <style>
    :root{
      /* Default (Day/White) theme */
      --bg: #f4f7fc;
      --text: #1a1f2c;
      --sub-text: #5a6476;
      --panel-bg: rgba(255, 255, 255, 0.5);
      --panel-border: rgba(0, 0, 0, 0.1);
      --shadow: 0 10px 30px rgba(0,0,0,0.1);
      --gold: #b58a00;
      --gold-gradient: linear-gradient(45deg, #d4af37, #fdf4d0, #b58a00);
    }
    /* Night theme */
    [data-theme='night']{
      --bg: #0a0c14;
      --text: #f4f6f9;
      --sub-text: #a8b2bd;
      --panel-bg: rgba(14, 19, 32, 0.5);
      --panel-border: rgba(255, 255, 255, 0.1);
      --shadow: 0 10px 40px rgba(0,0,0,0.4);
      --gold: #ffd54a;
      --gold-gradient: linear-gradient(45deg, #ffd54a, #fff, #ffd54a);
    }
    
    *{box-sizing:border-box}
    html,body{height:100%;-webkit-font-smoothing:antialiased}
    body{margin:0;font-family:'Amiri',serif;color:var(--text);background:var(--bg);overflow:hidden;transition:background .4s ease,color .4s ease}
    
    #three-bg {
        position: fixed;
        top: 0;
        left: 0;
        outline: none;
        z-index: -1;
    }

    .main-wrapper {height: 100vh;width: 100vw;overflow-y: auto;overflow-x: hidden;perspective: 10px;}

    header{position: sticky;top: 10px;z-index: 10;padding: 0 20px;display: flex;justify-content: center;}
    .nav{width: 100%;max-width: 1200px;padding: 10px 20px;display: flex;align-items: center;justify-content: space-between;background: var(--panel-bg);border-radius: 14px;border: 1px solid var(--panel-border);backdrop-filter: blur(12px);box-shadow: var(--shadow);}

    .brand{display:flex;align-items:center;gap:15px}
    
    /* NEW: Style for the user-provided GIF flag */
    .gif-flag {
        width: 50px;
        height: 33px;
        border-radius: 4px;
        border: 1px solid var(--panel-border);
        object-fit: cover; /* Ensures the GIF fills the container */
    }

    .header-title{margin:0;font-family:'Reem Kufi Fun';font-size:20px;background: var(--gold-gradient);-webkit-background-clip:text; -webkit-text-fill-color:transparent;}
    
    .icon-btn{background:transparent;border:0;padding:8px;cursor:pointer;color:var(--sub-text);display:grid;place-items:center}
    .icon-btn:hover{color: var(--gold);}
    .icon-btn svg {width: 24px; height: 24px;}
    
    /* FIXED: News Ticker CSS */
    .ticker-wrapper {
        position: sticky;
        top: 85px; /* Positioned below the header */
        z-index: 9;
        width: 100%;
        padding: 0 20px;
        margin-top: -10px;
        margin-bottom: 10px;
    }
    .news-ticker-container {
        max-width: 1200px;
        margin: 0 auto;
        display: flex;
        align-items: center;
        background-color: var(--panel-bg);
        backdrop-filter: blur(10px);
        border-radius: 12px;
        padding: 8px 15px;
        overflow: hidden;
        border: 1px solid var(--panel-border);
        box-shadow: var(--shadow);
    }
    .news-ticker-title {
        font-family: 'Reem Kufi Fun';
        font-size: 1rem;
        color: var(--gold);
        white-space: nowrap;
        padding-left: 15px;
    }
    .news-ticker-content {
        flex-grow: 1;
        position: relative;
        height: 24px; /* Fixed height for items */
        overflow: hidden;
    }
    .news-item {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        text-align: center;
        white-space: nowrap;
        font-size: 0.95rem;
        color: var(--sub-text);
        animation: slide-item 15s linear forwards;
    }
    
    /* The keyframes for the news item animation */
    @keyframes slide-item {
        0%   { transform: translateX(100%); opacity: 0; }
        10%  { transform: translateX(0); opacity: 1; }
        90%  { transform: translateX(0); opacity: 1; }
        100% { transform: translateX(-100%); opacity: 0; }
    }


    .hero{text-align:center;padding:80px 20px}
    .main-title{
        font-family:'Reem Kufi Fun';font-weight:700;font-size:clamp(40px,8vw,90px);margin:0;
        background: var(--gold-gradient);
        -webkit-background-clip:text;-webkit-text-fill-color:transparent;
        filter: drop-shadow(0 5px 20px rgba(181, 138, 0, 0.4));
        animation: shimmer 5s infinite ease-in-out;
        background-size: 200% 200%;
    }
    @keyframes shimmer { 0%{background-position:0% 50%} 50%{background-position:100% 50%} 100%{background-position:0% 50%} }
    
    .slider-container{padding: 40px 20px; position:relative;}
    .slide-wrap{max-width:1200px;margin:0 auto;position:relative;min-height:450px;}
    .slide{position:absolute;inset:0;display:grid;grid-template-columns:1fr 1fr;gap:20px;align-items:center;opacity:0;visibility:hidden;transition:opacity .8s ease;}
    .slide.active{opacity:1;visibility:visible}
    
    .slide-content {transform: translateX(-100px); transition: transform 1.2s cubic-bezier(.22,1,.36,1);}
    .slide.active .slide-content {transform: translateX(0);}
    
    .slide-image-flipper {
        perspective: 1500px;
        transform: translateX(100px);
        transition: transform 1.2s cubic-bezier(.22,1,.36,1);
        height: 450px;
    }
    .slide.active .slide-image-flipper {
        transform: translateX(0);
    }
    .flipper-card {
        width: 100%;
        height: 100%;
        position: relative;
        transform-style: preserve-3d;
        transition: transform 1s cubic-bezier(0.68, -0.55, 0.27, 1.55);
    }
    .flipper-card.is-flipped {
        transform: rotateY(180deg);
    }
    .card-face {
        position: absolute;
        width: 100%;
        height: 100%;
        backface-visibility: hidden;
        border-radius: 16px;
        overflow: hidden;
        box-shadow: var(--shadow);
    }
    .card-face img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    .card-face.card-back {
        transform: rotateY(180deg);
    }

    .slide-content{padding: 20px; background: var(--panel-bg); backdrop-filter: blur(12px); border-radius: 16px; border: 1px solid var(--panel-border);}
    .slide-content h3{margin:0 0 15px;font-family:'Reem Kufi Fun';font-size:clamp(28px,4vw,40px);color:var(--gold)}
    .slide-content p{margin:0 0 25px;font-size:1.2rem;line-height:1.9}
    
    .slider-nav {display:flex;justify-content:center;gap:15px;margin-top:40px;}
    .nav-arrow {width:50px;height:50px;border-radius:50%;border:1px solid var(--panel-border);background:var(--panel-bg);cursor:pointer;display:grid;place-items:center;color:var(--text);transition: all .3s ease;}
    .nav-arrow:hover{background:var(--gold);color:var(--bg);}
    
    .site-footer {padding: 40px 20px;margin-top: 80px;text-align: center;background: var(--panel-bg);backdrop-filter: blur(10px);border-top: 1px solid var(--panel-border);}
    .social-links a { color: var(--sub-text); margin: 0 10px; transition: color .3s ease;}
    .social-links a:hover { color: var(--gold); }
    .social-links svg {width: 24px; height: 24px;}
    .copyright {margin-top: 15px; font-size: 0.9rem; color: var(--sub-text);}

    /* Modal */
    .modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.7);backdrop-filter:blur(8px);z-index:100;display:grid;place-items:center;opacity:0;visibility:hidden;transition:all .4s ease}
    .modal-overlay.visible{opacity:1;visibility:visible}
    .modal-card{width:min(900px,95%);max-height:90vh;overflow-y:auto;border-radius:16px;padding:40px;background:var(--bg);border:1px solid var(--panel-border);position:relative;transform:scale(.9);transition:transform .4s ease}
    .modal-overlay.visible .modal-card {transform:scale(1);}
    .modal-close{position:absolute;top:15px;left:15px;cursor:pointer;color:var(--gold);width:40px;height:40px;background:var(--panel-bg);border:1px solid var(--panel-border);border-radius:50%;display:grid;place-items:center}
    
    @media (max-width:900px){.slide{grid-template-columns:1fr;text-align:center}.slide-image-flipper{height:300px}}
  </style>
</head>
<body data-theme="day">

  <canvas id="three-bg"></canvas>

  <div class="main-wrapper">
    <header>
      <div class="nav">
        <div class="brand">
          <!-- UPDATED: Replaced with user's GIF flag -->
          <img src="https://i.postimg.cc/7hjMcXpc/1iC-I4.gif" alt="علم مصر المتحرك" class="gif-flag">
          <h2 class="header-title">رؤية مصر 2030</h2>
        </div>
        <button class="icon-btn" id="themeBtn" title="تبديل الوضع">
          <svg id="theme-icon-sun" viewBox="0 0 24 24"><path fill="currentColor" d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.64 5.64c-.39-.39-1.02-.39-1.41 0s-.39 1.02 0 1.41l1.06 1.06c.39.39 1.02.39 1.41 0s.39-1.02 0-1.41L5.64 5.64zm12.73 12.73c-.39-.39-1.02-.39-1.41 0s-.39 1.02 0 1.41l1.06 1.06c.39.39 1.02.39 1.41 0s.39-1.02 0-1.41l-1.06-1.06zM5.64 18.36l1.06-1.06c.39-.39.39-1.02 0-1.41s-1.02-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.02 0 1.41s1.02.39 1.41 0zm12.73-12.73l1.06-1.06c.39-.39.39-1.02 0-1.41s-1.02-.39-1.41 0l-1.06 1.06c-.39-.39-.39 1.02 0 1.41s1.02.39 1.41 0z"/></svg>
          <svg id="theme-icon-moon" style="display:none;" viewBox="0 0 24 24"><path fill="currentColor" d="M11.23 3.41c.2-.2.52-.22.75-.05.23.17.34.45.28.72-1.35 5.56 3.48 10.39 9.04 9.04.27-.06.55.05.72.28.17.23.15.55-.05.75-2.58 2.58-6.15 4.15-10.04 4.15-6.63 0-12-5.37-12-12 0-3.89 1.57-7.46 4.15-10.04z"/></svg>
        </button>
      </div>
    </header>
    
    <!-- News Ticker Section -->
    <div class="ticker-wrapper">
        <div class="news-ticker-container">
            <span class="news-ticker-title">مصر الآن:</span>
            <div id="news-ticker-content" class="news-ticker-content">
                <!-- News items will be injected here by JavaScript -->
            </div>
        </div>
    </div>

    <main>
      <section class="hero">
          <h2 class="main-title">مصر تُبهر العالم</h2>
      </section>

      <section class="slider-container">
        <div class="slide-wrap" id="slide-wrap"></div>
        <div class="slider-nav">
          <button class="nav-arrow" id="prevBtn" aria-label="السابق"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M15.41 16.59L10.83 12l4.58-4.59L14 6l-6 6 6 6 1.41-1.41z"/></svg></button>
          <button class="nav-arrow" id="nextBtn" aria-label="التالي"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"/></svg></button>
        </div>
      </section>
    </main>
    
    <div class="modal-overlay" id="modal">
      <div class="modal-card">
        <button class="modal-close" id="closeModal"><svg viewBox="0 0 24 24"><path fill="currentColor" d="M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12z"/></svg></button>
        <h3 id="modal-title"></h3>
        <p id="modal-body"></p>
      </div>
    </div>
    
    <footer class="site-footer">
        <div class="social-links">
            <a href="#" aria-label="فيسبوك"><svg viewBox="0 0 24 24"><path fill="currentColor" d="M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.84 3.44 8.87 8 9.8V15H8v-3h2V9.5C10 7.57 11.57 6 13.5 6H16v3h-2c-.55 0-1 .45-1 1v2h3v3h-3v6.95c5.05-.5 9-4.76 9-9.95z"/></svg></a>
            <a href="#" aria-label="تويتر"><svg viewBox="0 0 24 24"><path fill="currentColor" d="M22.46 6c-.77.35-1.6.58-2.46.67.88-.53 1.56-1.37 1.88-2.38-.83.49-1.75.85-2.72 1.04C18.37 4.5 17.26 4 16 4c-2.35 0-4.27 1.92-4.27 4.29 0 .34.04.67.11.98C8.28 9.09 5.11 7.38 3 4.79c-.37.63-.58 1.37-.58 2.15 0 1.49.75 2.81 1.91 3.56-.71 0-1.37-.22-1.95-.54v.03c0 2.08 1.48 3.82 3.44 4.21a4.22 4.22 0 0 1-1.93.07 4.28 4.28 0 0 0 4 2.98 8.52 8.52 0 0 1-5.33 1.84c-.34 0-.68-.02-1.01-.06C3.18 20.79 5.38 21.5 7.7 21.5c7.32 0 11.33-6.06 11.33-11.33 0-.17 0-.34-.01-.51.78-.56 1.45-1.26 1.99-2.03z"/></svg></a>
        </div>
        <p class="copyright" id="copyright"></p>
    </footer>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script>
    const PROJECTS = [
        {id:1,title:"العاصمة الإدارية الجديدة",desc:"مدينة مستقبل ذكية — أحياء حكومية وأعمال وثقافة.",images:["https://i.postimg.cc/CxN62pxf/FB-IMG-1755179530591.jpg","https://i.postimg.cc/TP3HMNKN/FB-IMG-1755179596151.jpg"],more:"العاصمة الإدارية الجديدة هي المشروع القومي الأضخم في مصر الحديثة، مصممة لتكون مدينة عالمية ذكية ومستدامة، وتضم مقرات حكومية متطورة، وحي المال والأعمال، ومدينة الثقافة والفنون، بالإضافة إلى بنية تحتية فائقة الحداثة."},
        {id:2,title:"محطة بنبان للطاقة الشمسية",desc:"أحد أكبر مجمعات الطاقة الشمسية عالميًا.",images:["https://i.postimg.cc/wx18sMT4/image.jpg","https://i.postimg.cc/yxgP6wKn/1557299811-553-175541-1920-zonnepark41200x675.jpg"],more:"تعد محطة بنبان للطاقة الشمسية في أسوان واحدة من أكبر محطات الطاقة الشمسية في العالم، وهي ركيزة أساسية في استراتيجية مصر للطاقة المتجددة، وتساهم بشكل كبير في تحقيق أهداف التنمية المستدامة وتقليل الانبعاثات الكربونية."},
        {id:3,title:"مبادرة حياة كريمة",desc:"تطوير شامل للريف المصري — إسكان وخدمات.",images:["https://i.postimg.cc/8C4wZRwd/image.jpg","https://i.postimg.cc/q74jcbcM/19-2024-638474847516318591-631.jpg"],more:"مبادرة حياة كريمة هي مشروع قومي إنساني يهدف إلى تحسين جودة الحياة في القرى الأكثر احتياجاً، من خلال تطوير شامل للبنية التحتية والخدمات الصحية والتعليمية والسكن، مما يحقق عدالة اجتماعية وتنمية حقيقية."},
    ];

    const NEWS_ITEMS = [
        "مشروع الدلتا الجديدة يستهدف استصلاح أكثر من مليون فدان لتحقيق الأمن الغذائي.",
        "افتتاح المتحف المصري الكبير كأكبر متحف في العالم مخصص لحضارة واحدة.",
        "شبكة القطار الكهربائي السريع تربط أنحاء الجمهورية لأول مرة بسرعة وكفاءة.",
        "مصر تطلق القمر الصناعي \"طيبة-1\" لتعزيز خدمات الاتصالات والإنترنت.",
        "تطوير منطقة قناة السويس الاقتصادية لجذب استثمارات عالمية بمليارات الدولارات.",
        "مشروع \"مستقبل مصر\" للإنتاج الزراعي يوفر آلاف فرص العمل.",
        "تبطين وتأهيل الترع بأطوال تتجاوز 20 ألف كيلومتر للحفاظ على الموارد المائية.",
        "إنشاء أكبر مصنع للغزل والنسيج في العالم بمدينة المحلة الكبرى.",
        "مدينة العلمين الجديدة تتحول إلى مركز سياحي وتعليمي عالمي على ساحل المتوسط.",
        "تطوير شبكة الطرق والكباري بأكثر من 7000 كيلومتر لتسهيل حركة النقل.",
        "مشروع محطة الضبعة النووية يدخل مصر عصر الطاقة النووية السلمية.",
        "مصر تحقق الاكتفاء الذاتي من الغاز الطبيعي وتتحول إلى مركز إقليمي للطاقة."
    ];


    const els={body:document.body,slideWrap:document.getElementById('slide-wrap'),modal:document.getElementById('modal'),modalTitle:document.getElementById('modal-title'),modalBody:document.getElementById('modal-body'),closeModalBtn:document.getElementById('closeModal'),themeBtn:document.getElementById('themeBtn'),prevBtn:document.getElementById('prevBtn'),nextBtn:document.getElementById('nextBtn'),copyright:document.getElementById('copyright'), newsTicker: document.getElementById('news-ticker-content')};
    let currentIndex=0, slideshowInterval, flipInterval;
    const SLIDESHOW_DELAY = 8000;
    const FLIP_DELAY = SLIDESHOW_DELAY / 2;

    function buildSlides(){
        els.slideWrap.innerHTML=PROJECTS.map((p,i)=>`
            <article class="slide ${i===0?'active':''}" data-index="${i}">
                <div class="slide-image-flipper">
                    <div class="flipper-card" data-flipper-for="${i}">
                        <div class="card-face card-front"><img src="${p.images[0]}" alt="${p.title} 1"/></div>
                        <div class="card-face card-back"><img src="${p.images[1]}" alt="${p.title} 2"/></div>
                    </div>
                </div>
                <div class="slide-content">
                    <h3>${p.title}</h3><p>${p.desc}</p>
                    <button class="icon-btn" style="align-self:start" data-id="${p.id}">المزيد من التفاصيل</button>
                </div>
            </article>`).join('')
    }
    
    function setActiveSlide(index){
        document.querySelectorAll('.flipper-card').forEach(f => f.classList.remove('is-flipped'));
        document.querySelector('.slide.active').classList.remove('active');
        document.querySelector(`.slide[data-index="${index}"]`).classList.add('active');
    }

    function changeSlide(dir){
        currentIndex=(currentIndex+dir+PROJECTS.length)%PROJECTS.length;
        setActiveSlide(currentIndex);
        resetIntervals();
    }
    
    function resetIntervals(){
        clearInterval(slideshowInterval);
        clearTimeout(flipInterval);
        slideshowInterval=setInterval(()=>changeSlide(1), SLIDESHOW_DELAY);
        flipInterval = setTimeout(() => {
            const currentFlipper = document.querySelector(`.flipper-card[data-flipper-for="${currentIndex}"]`);
            if(currentFlipper) currentFlipper.classList.add('is-flipped');
        }, FLIP_DELAY);
    }

    // FIXED: News Ticker Logic
    let newsIndex = 0;
    function runNewsTicker() {
        if (!els.newsTicker || NEWS_ITEMS.length === 0) return;

        // Create the news item
        const newsItem = document.createElement('div');
        newsItem.className = 'news-item';
        newsItem.textContent = NEWS_ITEMS[newsIndex];
        
        // Add item to the DOM
        els.newsTicker.appendChild(newsItem);

        // Listener to remove the element after its animation finishes
        newsItem.addEventListener('animationend', () => {
            newsItem.remove();
        });

        // Move to the next news item for the next cycle
        newsIndex = (newsIndex + 1) % NEWS_ITEMS.length;

        // The animation itself is 15s. We'll start the next one after 15s to ensure they run sequentially without overlap.
        // A timeout inside a timeout creates a continuous loop.
        setTimeout(runNewsTicker, 15000); 
    }


    function init(){
        buildSlides();
        resetIntervals();
        
        // Start the first news item slightly delayed to let the page load
        setTimeout(runNewsTicker, 1000); 
        
        els.slideWrap.addEventListener('click',e=>{if(e.target.matches("button[data-id]")){const p=PROJECTS.find(p=>p.id==e.target.dataset.id);if(p){els.modalTitle.textContent=p.title;els.modalBody.textContent=p.more;els.modal.classList.add('visible')}}});
        els.closeModalBtn.addEventListener('click',()=>els.modal.classList.remove('visible'));
        els.themeBtn.addEventListener('click',()=>{const currentTheme=els.body.dataset.theme;const newTheme=currentTheme==='day'?'night':'day';els.body.dataset.theme=newTheme;document.getElementById('theme-icon-sun').style.display=newTheme==='day'?'block':'none';document.getElementById('theme-icon-moon').style.display=newTheme==='day'?'none':'block'});
        els.prevBtn.addEventListener('click',()=>changeSlide(-1));
        els.nextBtn.addEventListener('click',()=>changeSlide(1));
        els.copyright.textContent=`© ${new Date().getFullYear()} رؤية مصر 2030. جميع الحقوق محفوظة.`
    }
    
    // --- THREE.JS SETUP WITH MOUSE PARALLAX EFFECT ---
    const scene=new THREE.Scene();const camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,0.1,1000);const renderer=new THREE.WebGLRenderer({canvas:document.getElementById('three-bg'),alpha:true});renderer.setSize(window.innerWidth,window.innerHeight);camera.position.z=5;const pyramidGeo=new THREE.ConeGeometry(1,2,4);const pyramidMat=new THREE.MeshBasicMaterial({color:0xD4AF37,wireframe:true});const pyramids=[];for(let i=0;i<50;i++){const p=new THREE.Mesh(pyramidGeo,pyramidMat);p.position.set((Math.random()-.5)*50,(Math.random()-.5)*50,(Math.random()-.5)*50);p.rotation.set(Math.random()*Math.PI,Math.random()*Math.PI,Math.random()*Math.PI);pyramids.push(p);scene.add(p)}
    const particlesGeo=new THREE.BufferGeometry;const particlesCnt=5000;const posArray=new Float32Array(particlesCnt*3);for(let i=0;i<particlesCnt*3;i++){posArray[i]=(Math.random()-.5)*100}
    particlesGeo.setAttribute('position',new THREE.BufferAttribute(posArray,3));const particlesMat=new THREE.PointsMaterial({size:0.015,color:0xD4AF37});const particlesMesh=new THREE.Points(particlesGeo,particlesMat);scene.add(particlesMesh);
    
    const mouse = new THREE.Vector2();
    const target = new THREE.Vector2();
    const windowHalf = new THREE.Vector2(window.innerWidth / 2, window.innerHeight / 2);

    function onMouseMove(event) {
      mouse.x = (event.clientX - windowHalf.x);
      mouse.y = (event.clientY - windowHalf.y);
    }
    document.addEventListener('mousemove', onMouseMove);

    function animate(){
        requestAnimationFrame(animate);
        
        target.x = (mouse.x - target.x) * 0.02;
        target.y = (mouse.y - target.y) * 0.02;
        
        camera.position.x = target.x * 0.003;
        camera.position.y = target.y * -0.003;
        camera.lookAt(scene.position);

        particlesMesh.rotation.y+=.0002;
        pyramids.forEach(p=>{p.rotation.x+=.0005;p.rotation.y+=.0005});
        renderer.render(scene,camera)
    }

    window.addEventListener('resize',()=>{renderer.setSize(window.innerWidth,window.innerHeight);camera.aspect=window.innerWidth/window.innerHeight;camera.updateProjectionMatrix(); windowHalf.set(window.innerWidth / 2, window.innerHeight / 2);});
    init();
    animate();
  </script>
</body>
</html>
